[Unit]
Description=MoaT-KV main server
After=serf.service, mosquitto.service
Wants=serf.service, mosquitto.service
Conflicts=moat-kv-recover.service
Conflicts=distkv.service
OnFailure=moat-kv-recover.service

ConditionFileNotEmpty=/etc/moat/moat.cfg

[Install]
WantedBy=multi-user.target

[Service]
Type=notify
ExecStart=/usr/lib/moat/kv/run
ExecStartPost=/usr/lib/moat/kv/success
SuccessExitStatus=42

User=MoaT-KV
Group=MoaT

EnvironmentFile=/usr/lib/moat/kv/env
EnvironmentFile=-/etc/moat/kv.env

TimeoutSec=300
WatchdogSec=10
